---
{"dg-home":true,"dg-publish":true,"permalink":"/topological-insulators/24-10-23/","tags":["gardenEntry"],"dgPassFrontmatter":true}
---









>[!info]
==Reference==:Edge States and Topological Invariants of Non-Hermitian SystemsPHYSICAL REVIEW LETTERS 121, 086803 (2018)



![Pasted image 20241023095103.png|600](/img/user/topological%20insulators/attachments/Pasted%20image%2020241023095103.png)
```matlab

clc;   
clear;
N=102;
t_1=linspace(-3,3,N);
W=[];
for i=1:length(t_1)
    t1=t_1(i);
    [q,q1]=H(t1);
    dq=q(2:end)-q(1:end-1);
    W(1,i)=real(1i*sum(q1(1:end-1).*dq)/(2*pi));
end
t_1=linspace(-3,3,N);
plot(t_1,W,'*')

function [q,q1]=H(t1)

N=150;  t2=1;  gamma=4/3;
k=linspace(-pi,pi,N);
q=[];  q1=[];
for j=1:length(k)
r=sqrt(abs((t1-gamma/2)/(t1+gamma/2)));
beta=r*exp(1i*k(j));
h1=(t1-gamma/2+beta*t2)*[0 0;1 0]+(t1+gamma/2+1/beta*t2)*[0 1;0 0];
[V,~]=eig(h1);
u_R=V(:,1);   u_RR=[1 0;0 -1]*u_R; 
u_L1=inv(V)';  u_L=u_L1(:,1);   u_LL=[1 0;0 -1]*u_L;
Q=u_RR*u_LL'-u_R*u_L';
q=[q,Q(1,2)];
q1=[q1,Q(2,1)];
end

end
```


>[!info]
>==reference==:![attachments/Pasted image 20241023102114.png|600](/img/user/topological%20insulators/attachments/Pasted%20image%2020241023102114.png)
>![attachments/Pasted image 20241023102242.png|600](/img/user/topological%20insulators/attachments/Pasted%20image%2020241023102242.png)


```matlab
% [[Generlized Topology in Lattice Models without Chrial Symmetry]]
% 2024.10.21
% question :projected  winding number fig2(d)
%%  fig2(d)
clc;
clear;
t=linspace(-5,5,100);
e=linspace(-10,10,200);
v=1;
N=1000;
k=linspace(-pi,pi,N);
dk=(2*pi)/(N-1);
w_3=[];
for j=1:length(t)
    w_2=[];
    for n=1:length(e)
        w_1=0;
        for m=1:length(k)
            a=sqrt(4*t(j)^2+v^2);
            g_k=[a*cos(k(m))+(v^2+2*t(j)*e(n))/a,sin(k(m))*v];
            dg_k=[-sin(k(m))*a,cos(k(m))*v];
            Mg_k=((a*cos(k(m))+(v^2+2*t(j)*e(n))/a)^2+(sin(k(m))*v)^2);
             w=dk*(g_k(1,1)*dg_k(1,2)-dg_k(1,1)*g_k(1,2))/(2*pi*Mg_k);
w_1=w_1+w;
        end
w_2=[w_2;w_1];
    end
    w_3=[w_3,w_2];
end
w_4=round(w_3);
    % 创建网格坐标
x_values = linspace(-5,5,100); % 横坐标范围
y_values =linspace(-10,10,200); % 纵坐标范围
[X, Y] = meshgrid(x_values, y_values);
% 绘制相图
contourf(X, Y, w_4);
colormap(addcolorplus(344))
colorbar
axis equal
%%  引入φ,t=3
clc;
clear;
t=3;
phi=linspace(0,2*pi,100);
e=linspace(-10,10,200);
v=1;
N=1000;
k=linspace(-pi,pi,N);
dk=(2*pi)/(N-1);
w_3=[];
for j=1:length(phi)
    w_2=[];
    for n=1:length(e)
        w_1=0;
        for m=1:length(k)
            a=sqrt(4*t^2+v^2);
            g_k=[a*cos(k(m)+phi(j))+(v^2+2*t*e(n))/a,sin(k(m)+phi(j))*v];
            dg_k=[-sin(k(m)+phi(j))*a,cos(k(m)+phi(j))*v];
            Mg_k=((a*cos(k(m)+phi(j))+(v^2+2*t*e(n))/a)^2+(sin(k(m)+phi(j))*v)^2);
             w=dk*(g_k(1,1)*dg_k(1,2)-dg_k(1,1)*g_k(1,2))/(2*pi*Mg_k);
w_1=w_1+w;
        end
w_2=[w_2;w_1];
    end
    w_3=[w_3,w_2];
end
w_4=round(w_3);
    % 创建网格坐标
x_values = linspace(0,2*pi,100); % 横坐标范围
y_values =linspace(-10,10,200); % 纵坐标范围
[X, Y] = meshgrid(x_values, y_values);
% 绘制相图
contourf(X, Y, w_4);
colormap(addcolorplus(344))
colorbar
axis equal
  H
h1=t1+t2/beta_0+gamma;
h2=t1+t2*beta_0-gamma;
Hbeta=[0,h1;h2,0];
Hbeta=[Hbeta+eye(2)*w,[0,lambda/2;lambda/2,0];[0,lambda/2;lambda/2,0],Hbeta];
H2=Hbeta-E*eye(4);
f=det(H2);             % 久期方程 
%% aGBZ
coe=coeffs(f,E);       % 取多项式的系数
coe2=subs(coe,beta_0,beta_0*exp(1i*theta_0));  % 取含exp(1*theta)的多项式的系数
S=[coe(5) coe(4) coe(3) coe(2) coe(1) 0 0 0;0 coe(5) coe(4) coe(3) coe(2) coe(1) 0 0;...
    0 0 coe(5) coe(4) coe(3) coe(2) coe(1)  0;0 0 0 coe(5) coe(4) coe(3) coe(2) coe(1);...
    coe2(5) coe2(4) coe2(3) coe2(2) coe2(1) 0 0 0;0 coe2(5) coe2(4) coe2(3) coe2(2) coe2(1) 0 0;...
    0 0 coe2(5) coe2(4) coe2(3) coe2(2) coe2(1)  0;0 0 0 coe2(5) coe2(4) coe2(3) coe2(2) coe2(1)];
f_beta=det(S);    % 消掉本征值
beta0=solve(f_beta,beta_0);  % aGBZ的解析形似解
%% numerics of aGBZ
theta_vector=0:0.2:2*pi;
beta_root=zeros(16,length(theta_vector));
for i=1:length(theta_vector)
    beta_root(:,i)=double(subs(beta0,theta_0,theta_vector(i))); % aGBZ的数值解
end
%% The possible energy
beta_aGBZ=beta_root(:);   % 矩阵变为列数组
E_root=solve(f,E);        % 本征值的解析形式解
E_aGBZ=zeros(4,length(beta_aGBZ));
for i=1:length(beta_aGBZ)
    E_aGBZ(:,i)=double(subs(E_root,beta_0,beta_aGBZ(i))); % 本征值的数值解
end
E_aGBZ=E_aGBZ(:);   % 矩阵变为列数组
%% the root of f
beta_root2=solve(f,beta_0);  % beta 的解析形似解
beta2=zeros(4,length(E_aGBZ));
for i=1:length(E_aGBZ)
    beta2(:,i)=double(subs(beta_root2,E,E_aGBZ(i))); % beta的数值解
end
 basic input parameters
clc;
clear;
t1=0.75;
t2=1;
lambda=0.5;
w=3;
T=2*pi/w;
gamma=0.2;
%% f(e,beta)
syms beta theta E
h1=t1+t2/beta+lambda/(w*T)*sin(w*T)+gamma;
h2=t1+t2*beta+lambda/(w*T)*sin(w*T)-gamma;
%h1=t1+t2/beta+gamma;
%h2=t1+t2*beta-gamma;有效H和普通的没有区别
Hbeta=[0,h1;h2,0];
Hbeta=[Hbeta+eye(2)*w,[0,lambda/2;lambda/2,0];[0,lambda/2;lambda/2,0],Hbeta];
H2=Hbeta-E*eye(4);
f=det(H2);             % 久期方程 
% GBZ for non-Hermitian two bands model
%% aGBZ
coe=coeffs(f,E);       % 取多项式的系数
coe2=subs(coe,beta,beta*exp(1i*theta));  % 取含exp(1*theta)的多项式的系数
S=[coe(5) coe(4) coe(3) coe(2) coe(1) 0 0 0;0 coe(5) coe(4) coe(3) coe(2) coe(1) 0 0;...
    0 0 coe(5) coe(4) coe(3) coe(2) coe(1)  0;0 0 0 coe(5) coe(4) coe(3) coe(2) coe(1);...
    coe2(5) coe2(4) coe2(3) coe2(2) coe2(1) 0 0 0;0 coe2(5) coe2(4) coe2(3) coe2(2) coe2(1) 0 0;...
    0 0 coe2(5) coe2(4) coe2(3) coe2(2) coe2(1)  0;0 0 0 coe2(5) coe2(4) coe2(3) coe2(2) coe2(1)];
f_beta=det(S);    % 消掉本征值
beta0=solve(f_beta,beta);  % aGBZ的解析形似解
%% numerics of aGBZ
theta_vector=0.05:0.5:2*pi-0.05;
beta_root=zeros(16,length(theta_vector));
for i=1:length(theta_vector)
    beta_root(:,i)=double(subs(beta0,theta,theta_vector(i))); % aGBZ的数值解
end
plot(beta_root,'.');%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% The possible energy
beta_aGBZ=beta_root(:);   % 矩阵变为列数组
E_root=solve(f,E);        % 本征值的解析形式解
E_aGBZ=zeros(4,length(beta_aGBZ));
for i=1:length(beta_aGBZ)
    E_aGBZ(:,i)=double(subs(E_root,beta,beta_aGBZ(i))); % 本征值的数值解
end
E_aGBZ=E_aGBZ(:);   % 矩阵变为列数组
%% the root of f
beta_root2=solve(f,beta);  % beta 的解析形似解
beta2=zeros(4,length(E_aGBZ));
for i=1:length(E_aGBZ)
    beta2(:,i)=double(subs(beta_root2,E,E_aGBZ(i))); % beta的数值解
end
%% GBZ
m=1;
for i=1:length(E_aGBZ)   
    [b_abs,I2]=sort(abs(beta2(:,i)));        % beta按照模大小排序
    if abs(abs(b_abs(2)-b_abs(3)))<10^(-5)   % 选取|beta_2|=|beta_3|的情况
         beta_all(:,m)=beta2(I2,i);          % all beta
         Energy(m)=E_aGBZ(i);                % energy
         m=m+1; 
    end
end
%beta_GBZ=[beta_all(2,:),beta_all(3,:)];   % GBZ
  U_0
tt=linspace(0,T/2,N);
dtt=T/(2*(N-1));
U_0=eye(2);
for jj=1:length(tt)
    h1=t1(ii)+t2/beta+lambda*cos(w*tt(jj))+gamma;
    h2=t1(ii)+t2*beta+lambda*cos(w*tt(jj))-gamma;
    H1=[0 h1;h2 0];
    U_beta_halfT=expm(-1i*H1*dtt);
U_0=U_beta_halfT*expm(1i*H_eff*tt(jj))*U_0;
end
U_0_add(1,i)=U_0(1,2); %--------计算W_pi::  U_0_add(1,i)=U_0(1,1);------------------------------
end

%
dU=U_0_add(2:end)-U_0_add(1:end-1);
U_inv=U_0_add(1:end-1);
W_0(1,ii)=1i/(2*pi)*sum((1./U_inv).*dU);
end
%
t1=linspace(-2,2,40);
plot(t1,W_0,'r--')

```
>[!tip]
>这里应该是0
![attachments/Pasted image 20241023202610.png|400](/img/user/topological%20insulators/attachments/Pasted%20image%2020241023202610.png)